var html_utils={};function make_html_utils_lib(XLSX){function is_dom_element_hidden(element){var display="",get_computed_style=function(element){return element.ownerDocument.defaultView&&"function"==typeof element.ownerDocument.defaultView.getComputedStyle?element.ownerDocument.defaultView.getComputedStyle:"function"==typeof getComputedStyle?getComputedStyle:null}(element);return get_computed_style&&(display=get_computed_style(element).getPropertyValue("display")),display||(display=element.style.display),"none"===display}var entities,htmldecode=(entities=[["nbsp"," "],["middot","Â·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(x){return[new RegExp("&"+x[0]+";","g"),x[1]]}),function(str){for(var o=str.trim().replace(/\s+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),i=0;i<entities.length;++i)o=o.replace(entities[i][0],entities[i][1]);return o});function encode_cell(cell){return function(col){var s="";for(++col;col;col=Math.floor((col-1)/26))s=String.fromCharCode((col-1)%26+65)+s;return s}(cell.c)+(""+(cell.r+1))}function encode_range(cs,ce){return void 0===ce||"number"==typeof ce?encode_range(cs.s,cs.e):("string"!=typeof cs&&(cs=encode_cell(cs)),"string"!=typeof ce&&(ce=encode_cell(ce)),cs==ce?cs:cs+":"+ce)}function table_to_book(table,opts){return function(sheet,opts){var n=opts&&opts.sheet?opts.sheet:"Sheet1",sheets={};return sheets[n]=sheet,{SheetNames:[n],Sheets:sheets}}(function(table,_opts){var opts=_opts||{},ws=opts.dense?[]:{},rows=table.getElementsByTagName("tr"),sheetRows=opts.sheetRows||1e7,range={s:{r:0,c:0},e:{r:0,c:0}},merges=[],midx=0,rowInfo=[],_colWidths=table.getAttribute("data-cols-width");if(_colWidths)var colInfo=_colWidths.split(",").map(function(i){return{wch:parseInt(i)}});for(var _C,C,RS,CS,_R=0,R=0;_R<rows.length&&R<sheetRows;++_R){var row=rows[_R];if(is_dom_element_hidden(row)){if(opts.display)continue;rowInfo[R]={hidden:!0}}var elts=row.children;for(_C=C=0;_C<elts.length;++_C){var elt=elts[_C];if(!("true"==elt.getAttribute("data-exclude")||opts.display&&is_dom_element_hidden(elt))){var v=htmldecode(elt.innerHTML);for(midx=0;midx<merges.length;++midx){var m=merges[midx];m.s.c==C&&m.s.r<=R&&R<=m.e.r&&(C=m.e.c+1,midx=-1)}CS=+elt.getAttribute("colspan")||1,(0<(RS=+elt.getAttribute("rowspan"))||1<CS)&&merges.push({s:{r:R,c:C},e:{r:R+(RS||1)-1,c:C+CS-1}});var o={t:"s",v:v,s:{font:{},border:{},alignment:{}}},_t=elt.getAttribute("data-t"),_fillFgColor=elt.getAttribute("data-fill-color"),_fontName=elt.getAttribute("data-f-name"),_fontSz=elt.getAttribute("data-f-sz"),_fontBold=elt.getAttribute("data-f-bold"),_fontColor=elt.getAttribute("data-f-color"),_underline=elt.getAttribute("data-f-underline"),_italic=elt.getAttribute("data-f-italic"),_strike=elt.getAttribute("data-f-strike"),_numFmt=elt.getAttribute("data-num-fmt"),_aHorizontal=elt.getAttribute("data-a-h"),_aVertical=elt.getAttribute("data-a-v"),_aWrap=elt.getAttribute("data-a-wrap"),_txtRotation=elt.getAttribute("data-a-text-rotation"),_b_t_s=elt.getAttribute("data-b-t-s"),_b_b_s=elt.getAttribute("data-b-b-s"),_b_l_s=elt.getAttribute("data-b-l-s"),_b_r_s=elt.getAttribute("data-b-r-s"),_b_a_s=elt.getAttribute("data-b-a-s"),_link_target=elt.getAttribute("data-link");null!=v&&(0==v.length?o.t=_t||"z":opts.raw||0==v.trim().length||"s"==_t||_t&&_t.length&&(o.t=_t),_fontName&&(o.s.font.name=_fontName),_fontSz&&(o.s.font.sz=_fontSz),_fontBold&&(o.s.font.bold=_fontBold),_fontColor&&(o.s.font.color={rgb:_fontColor}),_underline&&(o.s.font.underline=_underline),_italic&&(o.s.font.italic=_italic),_strike&&(o.s.font.strike=_strike),_numFmt&&(o.s.numFmt=_numFmt),_aHorizontal&&(o.s.alignment.horizontal=_aHorizontal),_aVertical&&(o.s.alignment.vertical=_aVertical),_aWrap&&(o.s.alignment.wrapText=_aWrap),_txtRotation&&(o.s.alignment.textRotation=_txtRotation),_b_a_s?(o.s.border.top={style:_b_a_s},o.s.border.bottom={style:_b_a_s},o.s.border.left={style:_b_a_s},o.s.border.right={style:_b_a_s}):(_b_t_s&&(o.s.border.top={style:_b_t_s}),_b_b_s&&(o.s.border.bottom={style:_b_b_s}),_b_l_s&&(o.s.border.left={style:_b_l_s}),_b_r_s&&(o.s.border.right={style:_b_r_s})),_fillFgColor&&(o.s.fill={patternType:"solid",fgColor:{rgb:_fillFgColor}}),_link_target&&(o.l={Target:_link_target,Tooltip:_link_target})),opts.dense?(ws[R]||(ws[R]=[]),ws[R][C]=o):ws[encode_cell({c:C,r:R})]=o,range.e.c<C&&(range.e.c=C),C+=CS}}++R}return merges.length&&(ws["!merges"]=merges),rowInfo.length&&(ws["!rows"]=rowInfo),colInfo&&colInfo.length&&(ws["!cols"]=colInfo),range.e.r=R-1,ws["!ref"]=encode_range(range),sheetRows<=R&&(ws["!fullref"]=encode_range((range.e.r=rows.length-_R+R-1,range))),ws}(table,opts),opts)}html_utils.table_to_book=table_to_book,html_utils.save_table_as_excel=function(table,opts){if("undefined"==typeof saveAs)throw new Error("FileSave.js is required. https://github.com/eligrey/FileSaver.js/blob/master/src/FileSaver.js");var fileName="excel-export.xlsx";opts.name&&(fileName=opts.name,delete opts.name),0===Object.keys(opts).length&&opts.constructor===Object&&(opts={}),opts.bookSST||(opts.bookSST=!1),opts.bookType||(opts.bookType="xlsx"),opts.type||(opts.type="binary");var wb=table_to_book(table),wbout=XLSX.write(wb,opts);saveAs(new Blob([function(s){for(var buf=new ArrayBuffer(s.length),view=new Uint8Array(buf),i=0;i<s.length;i++)view[i]=255&s.charCodeAt(i);return buf}(wbout)],{type:"application/octet-stream"}),fileName)}}if("undefined"==typeof XLSX)throw new Error("You need to include xlsx.core.min.js (https://github.com/protobi/js-xlsx/blob/master/dist/xlsx.core.min.js)  before xlsx_html_utils.js");make_html_utils_lib(XLSX),XLSX.utils.html=html_utils;